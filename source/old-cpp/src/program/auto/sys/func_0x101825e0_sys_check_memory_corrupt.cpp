FUNC_BEGIN(sys_check_memory_corrupt, 0xdd5d5efe407b84ea, 0x20, ({0x53, 0x51, 0x52, 0x57, 0x89, 0xc2, 0x89, 0xc3, 0x8b, 0x48, 0x4, 0x83, 0xc0, 0x4, 0x81, 0xf9, 0xce, 0xfa, 0xed, 0xfe, 0x74, 0xd, 0x68, 0x84, 0x33, 0x1b, 0x10, 0xe8, 0xa8, 0x2, 0, 0, 0x83, 0xc4, 0x4, 0x3, 0x13, 0x8b, 0x7a, 0xfc, 0x83, 0xea, 0x4, 0x81, 0xff, 0xfe, 0xca, 0xef, 0xbe, 0x74, 0xd, 0x68, 0x9c, 0x33, 0x1b, 0x10, 0xe8, 0x8b, 0x2, 0, 0, 0x83, 0xc4, 0x4, 0x5f, 0x5a, 0x59, 0x5b, 0xc3}))
    II(0x101825e0, 0x1)   pushd(ebx);                           /* push ebx */
    II(0x101825e1, 0x1)   pushd(ecx);                           /* push ecx */
    II(0x101825e2, 0x1)   pushd(edx);                           /* push edx */
    II(0x101825e3, 0x1)   pushd(edi);                           /* push edi */
    II(0x101825e4, 0x2)   mov(edx, eax);                        /* mov edx, eax */
    II(0x101825e6, 0x2)   mov(ebx, eax);                        /* mov ebx, eax */
    II(0x101825e8, 0x3)   mov(ecx, memd_a32(ds, eax + 0x4));    /* mov ecx, [eax+0x4] */
    II(0x101825eb, 0x3)   add(eax, 0x4);                        /* add eax, 0x4 */
    II(0x101825ee, 0x6)   cmp(ecx, 0xfeedface);                 /* cmp ecx, 0xfeedface */
    II(0x101825f4, 0x2)   jzd(0x10182603, 0xd);                 /* jz 0x10182603 */
    II(0x101825f6, 0x5)   pushd(0x101b3384);                    /* push dword 0x101b3384 */ /* "Memory header stomped.\n" */
    II(0x101825fb, 0x5)   calld(/* sys */ 0x101828a8, 0x2a8);   /* call 0x101828a8 */
    II(0x10182600, 0x3)   add(esp, 0x4);                        /* add esp, 0x4 */
l_0x10182603:
    II(0x10182603, 0x2)   add(edx, memd_a32(ds, ebx));          /* add edx, [ebx] */
    II(0x10182605, 0x3)   mov(edi, memd_a32(ds, edx - 0x4));    /* mov edi, [edx-0x4] */
    II(0x10182608, 0x3)   sub(edx, 0x4);                        /* sub edx, 0x4 */
    II(0x1018260b, 0x6)   cmp(edi, 0xbeefcafe);                 /* cmp edi, 0xbeefcafe */
    II(0x10182611, 0x2)   jzd(0x10182620, 0xd);                 /* jz 0x10182620 */
    II(0x10182613, 0x5)   pushd(0x101b339c);                    /* push dword 0x101b339c */ /* "Memory footer stomped.\n" */
    II(0x10182618, 0x5)   calld(/* sys */ 0x101828a8, 0x28b);   /* call 0x101828a8 */
    II(0x1018261d, 0x3)   add(esp, 0x4);                        /* add esp, 0x4 */
l_0x10182620:
    II(0x10182620, 0x1)   popd(edi);                            /* pop edi */
    II(0x10182621, 0x1)   popd(edx);                            /* pop edx */
    II(0x10182622, 0x1)   popd(ecx);                            /* pop ecx */
    II(0x10182623, 0x1)   popd(ebx);                            /* pop ebx */
    II(0x10182624, 0x1)   retd();                               /* ret */
FUNC_END

