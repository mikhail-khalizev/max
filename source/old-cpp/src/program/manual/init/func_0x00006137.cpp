FUNC_BEGIN(0x00006137, 0x5e70b3fae55d1cb7, 0x10, ({0x55, 0x8b, 0xec, 0x66, 0x60, 0xf, 0xa0, 0xf, 0xa8, 0xff, 0x36, 0xf8, 0xd, 0xf6, 0x6, 0x82, 0x15, 0x1, 0x75, 0x7f, 0xf6, 0x6, 0x47, 0, 0x80, 0x74, 0x5, 0xb8, 0x1b, 0x10, 0xcd, 0x15, 0xe, 0xe8, 0x80, 0xff, 0x66, 0xf, 0xbf, 0xe, 0xf0, 0xd, 0x66, 0xf7, 0xd1, 0x66, 0xf, 0xb7, 0x3e, 0xca, 0xe, 0x66, 0xc1, 0xe7, 0x6, 0x66, 0x8b, 0x56, 0x6, 0x66, 0x3b, 0xfa, 0x77, 0x3, 0x66, 0x8b, 0xfa, 0x66, 0x3, 0xf9, 0x66, 0xf7, 0xd1, 0x23, 0xf9, 0x66, 0xc1, 0xef, 0x6, 0x66, 0x23, 0x4e, 0xa, 0x66, 0xc1, 0xe9, 0x6, 0x66, 0x3, 0xfe, 0x66, 0x3, 0xce, 0x66, 0x89, 0x4e, 0xa, 0xeb, 0x4, 0x66, 0x83, 0xc7, 0x4, 0x66, 0x3b, 0xf9, 0x73, 0x1b, 0x26, 0x67, 0x66, 0x8b, 0x17, 0xf6, 0xc6, 0x4, 0x75, 0xed, 0x8b, 0xc2, 0x23, 0x6, 0xf2, 0xd, 0x3b, 0x6, 0xf2, 0xd, 0x75, 0xe1, 0xe8, 0x45, 0xff, 0xeb, 0xe0, 0xf6, 0x6, 0x47, 0, 0x80, 0x74, 0x5, 0xb8, 0x1c, 0x10, 0xcd, 0x15, 0x5b, 0xa1, 0xf8, 0xd, 0x2b, 0xc3, 0x89, 0x46, 0xfc, 0x74, 0x6, 0xf, 0x20, 0xdb, 0xf, 0x22, 0xdb, 0xf, 0xa9, 0xf, 0xa1, 0x66, 0x61, 0x5d, 0xcb}))
    II(0x00006137, 0x1)   pushw(bp);                            /* push bp */
    II(0x00006138, 0x2)   mov(bp, sp);                          /* mov bp, sp */
    II(0x0000613a, 0x2)   pushad();                             /* pushad  */
    II(0x0000613c, 0x2)   pushw(fs);                            /* push fs */
    II(0x0000613e, 0x2)   pushw(gs);                            /* push gs */
    II(0x00006140, 0x4)   pushw(memw_a16(ds, 0xdf8));           /* push word [0xdf8] */
    II(0x00006144, 0x5)   test(memb_a16(ds, 0x1582), 0x1);      /* test byte [0x1582], 0x1 */
    II(0x00006149, 0x2)   jnzw(0x000061ca, 0x7f);               /* jnz 0x61ca */
    II(0x0000614b, 0x5)   test(memb_a16(ds, 0x47), 0x80);       /* test byte [0x47], 0x80 */
    II(0x00006150, 0x2)   jzw(0x00006157, 0x5);                 /* jz 0x6157 */
    II(0x00006152, 0x3)   mov(ax, 0x101b);                      /* mov ax, 0x101b */
    II(0x00006155, 0x2)   int_(0x15);                           /* int 0x15 */
l_0x00006157:
    II(0x00006157, 0x1)   pushw(cs);                            /* push cs */
    II(0x00006158, 0x3)   callw(0x000060db, -0x80);             /* call 0x60db */
    II(0x0000615b, 0x6)   movsx(ecx, memw_a16(ds, 0xdf0));      /* movsx ecx, word [0xdf0] */
    II(0x00006161, 0x3)   not_(ecx);                            /* not ecx */
    II(0x00006164, 0x6)   movzx(edi, memw_a16(ds, 0xeca));      /* movzx edi, word [0xeca] */
    II(0x0000616a, 0x4)   shl(edi, 0x6);                        /* shl edi, 0x6 */
    II(0x0000616e, 0x4)   mov(edx, memd_a16(ss, bp + 0x6));     /* mov edx, [bp+0x6] */
    II(0x00006172, 0x3)   cmp(edi, edx);                        /* cmp edi, edx */
    II(0x00006175, 0x2)   jaw(0x0000617a, 0x3);                 /* ja 0x617a */
    II(0x00006177, 0x3)   mov(edi, edx);                        /* mov edi, edx */
l_0x0000617a:
    II(0x0000617a, 0x3)   add(edi, ecx);                        /* add edi, ecx */
    II(0x0000617d, 0x3)   not_(ecx);                            /* not ecx */
    II(0x00006180, 0x2)   and_(di, cx);                         /* and di, cx */
    II(0x00006182, 0x4)   shr(edi, 0x6);                        /* shr edi, 0x6 */
    II(0x00006186, 0x4)   and_(ecx, memd_a16(ss, bp + 0xa));    /* and ecx, [bp+0xa] */
    II(0x0000618a, 0x4)   shr(ecx, 0x6);                        /* shr ecx, 0x6 */
    II(0x0000618e, 0x3)   add(edi, esi);                        /* add edi, esi */
    II(0x00006191, 0x3)   add(ecx, esi);                        /* add ecx, esi */
    II(0x00006194, 0x4)   mov(memd_a16(ss, bp + 0xa), ecx);     /* mov [bp+0xa], ecx */
    II(0x00006198, 0x2)   jmpw(0x0000619e, 0x4);                /* jmp 0x619e */
l_0x0000619a:
    II(0x0000619a, 0x4)   add(edi, 0x4);                        /* add edi, 0x4 */
l_0x0000619e:
    II(0x0000619e, 0x3)   cmp(edi, ecx);                        /* cmp edi, ecx */
    II(0x000061a1, 0x2)   jaew(0x000061be, 0x1b);               /* jae 0x61be */
    II(0x000061a3, 0x5)   mov(edx, memd_a32(es, edi));          /* mov edx, [es:edi] */
    II(0x000061a8, 0x3)   test(dh, 0x4);                        /* test dh, 0x4 */
    II(0x000061ab, 0x2)   jnzw(0x0000619a, -0x13);              /* jnz 0x619a */
    II(0x000061ad, 0x2)   mov(ax, dx);                          /* mov ax, dx */
    II(0x000061af, 0x4)   and_(ax, memw_a16(ds, 0xdf2));        /* and ax, [0xdf2] */
    II(0x000061b3, 0x4)   cmp(ax, memw_a16(ds, 0xdf2));         /* cmp ax, [0xdf2] */
    II(0x000061b7, 0x2)   jnzw(0x0000619a, -0x1f);              /* jnz 0x619a */
    II(0x000061b9, 0x3)   callw(0x00006101, -0xbb);             /* call 0x6101 */
    II(0x000061bc, 0x2)   jmpw(0x0000619e, -0x20);              /* jmp 0x619e */
l_0x000061be:
    II(0x000061be, 0x5)   test(memb_a16(ds, 0x47), 0x80);       /* test byte [0x47], 0x80 */
    II(0x000061c3, 0x2)   jzw(0x000061ca, 0x5);                 /* jz 0x61ca */
    II(0x000061c5, 0x3)   mov(ax, 0x101c);                      /* mov ax, 0x101c */
    II(0x000061c8, 0x2)   int_(0x15);                           /* int 0x15 */
l_0x000061ca:
    II(0x000061ca, 0x1)   popw(bx);                             /* pop bx */
    II(0x000061cb, 0x3)   mov(ax, memw_a16(ds, 0xdf8));         /* mov ax, [0xdf8] */
    II(0x000061ce, 0x2)   sub(ax, bx);                          /* sub ax, bx */
    II(0x000061d0, 0x3)   mov(memw_a16(ss, bp - 0x4), ax);      /* mov [bp-0x4], ax */
    II(0x000061d3, 0x2)   jzw(0x000061db, 0x6);                 /* jz 0x61db */
    II(0x000061d5, 0x3)   mov(ebx, cr3);                        /* mov ebx, cr3 */
//    II(0x000061d8, 0x3)   mov(cr3, ebx);                        /* mov cr3, ebx */
l_0x000061db:
    II(0x000061db, 0x2)   popw(gs);                             /* pop gs */
    II(0x000061dd, 0x2)   popw(fs);                             /* pop fs */
    II(0x000061df, 0x2)   popad();                              /* popad  */
    II(0x000061e1, 0x1)   popw(bp);                             /* pop bp */
    II(0x000061e2, 0x1)   retfw();                              /* retf  */
FUNC_END

